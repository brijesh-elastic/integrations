{
    "@timestamp": "2025-08-12T09:58:09.947Z",
    "agent": {
        "ephemeral_id": "f18befa1-0f74-40b4-bd7f-c93d017adbf8",
        "id": "c8b0424f-06be-4430-8217-b26e28f1be36",
        "name": "elastic-agent-85044",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "data_stream": {
        "dataset": "sysdig.cspm",
        "namespace": "30853",
        "type": "logs"
    },
    "ecs": {
        "version": "8.17.0"
    },
    "elastic_agent": {
        "id": "c8b0424f-06be-4430-8217-b26e28f1be36",
        "snapshot": false,
        "version": "8.16.0"
    },
    "event": {
        "agent_id_status": "verified",
        "dataset": "sysdig.cspm",
        "ingested": "2025-08-12T09:58:12Z",
        "kind": "event",
        "original": "{\"acceptedCount\":0,\"control\":{\"acceptedCount\":0,\"authors\":\"Sysdig\",\"description\":\"Ensure that your Amazon Lambda environment variables are using customer-managed Customer Master Keys (CMKs) instead of AWS managed-keys (i.e. default keys used when there are no customer keys defined) in order to benefit from a more granular control over the data encryption and decryption process. The environment variables defined for your Amazon Lambda functions are key-value pairs that are used to store configuration settings without the need to change function code.\",\"id\":\"21344\",\"isManual\":false,\"lastUpdate\":\"1752149383\",\"name\":\"Lambda - Enable Encryption at Rest for Environment Variables using Customer Master Keys\",\"objectsCount\":2879,\"pass\":false,\"passingCount\":0,\"platform\":\"\",\"remediationId\":\"21344\",\"resourceApiEndpoint\":\"/api/cspm/v1/cloud/resources?controlId=21344\\u0026providerType=AWS\\u0026resourceKind=AWS_LAMBDA_FUNCTION\\u0026filter=policyId=52 and zones.id=119\",\"resourceKind\":\"AWS_LAMBDA_FUNCTION\",\"severity\":\"High\",\"supportedDistributions\":[{\"maxVersion\":0,\"minVersion\":0,\"name\":\"AWS\"}],\"target\":\"AWS\",\"type\":8},\"description\":\"All Amazon Web Services Controls.\",\"failedControls\":136,\"highSeverityCount\":3147,\"lowSeverityCount\":2926,\"mediumSeverityCount\":20805,\"name\":\"AWS Controls\",\"pass\":false,\"passingCount\":23735,\"policyId\":\"52\",\"policyName\":\"All Posture Findings\",\"requirementId\":\"637489\",\"severity\":\"High\",\"zone\":{\"id\":\"119\",\"name\":\"Entire Infrastructure\"}}",
        "outcome": "failure",
        "severity": 73,
        "type": [
            "info"
        ]
    },
    "input": {
        "type": "cel"
    },
    "message": "AWS Controls",
    "observer": {
        "product": "Sysdig Secure",
        "vendor": "Sysdig"
    },
    "rule": {
        "id": "52",
        "name": "All Posture Findings"
    },
    "sysdig": {
        "cspm": {
            "accepted_count": 0,
            "control": {
                "accepted_count": 0,
                "authors": "Sysdig",
                "description": "Ensure that your Amazon Lambda environment variables are using customer-managed Customer Master Keys (CMKs) instead of AWS managed-keys (i.e. default keys used when there are no customer keys defined) in order to benefit from a more granular control over the data encryption and decryption process. The environment variables defined for your Amazon Lambda functions are key-value pairs that are used to store configuration settings without the need to change function code.",
                "id": "21344",
                "is_manual": false,
                "last_update": "2025-07-10T12:09:43.000Z",
                "name": "Lambda - Enable Encryption at Rest for Environment Variables using Customer Master Keys",
                "objects_count": 2879,
                "pass": false,
                "passing_count": 0,
                "remediation_id": "21344",
                "resource_api_endpoint": "/api/cspm/v1/cloud/resources?controlId=21344&providerType=AWS&resourceKind=AWS_LAMBDA_FUNCTION&filter=policyId=52 and zones.id=119",
                "resource_kind": "AWS_LAMBDA_FUNCTION",
                "severity": "High",
                "supported_distributions": [
                    {
                        "max_version": "0",
                        "min_version": "0",
                        "name": "AWS"
                    }
                ],
                "target": "AWS",
                "type": 8
            },
            "description": "All Amazon Web Services Controls.",
            "failed_controls": 136,
            "high_severity_count": 3147,
            "low_severity_count": 2926,
            "medium_severity_count": 20805,
            "pass": false,
            "passing_count": 23735,
            "requirement_id": "637489",
            "severity": "High",
            "zone": {
                "id": "119",
                "name": "Entire Infrastructure"
            }
        }
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "sysdig-cspm"
    ]
}
